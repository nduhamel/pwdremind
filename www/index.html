<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="./static/css/bootstrap.css">
    <link href="./static/css/bootstrap-responsive.css" rel="stylesheet">
    <link href="./static/css/main.css" rel="stylesheet">
    <title>Password Remind</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>
<script src="./static/js/sjcl.js"></script>

<script src="./static/js/jquery.js"></script>

<script src="./static/js/bootstrap/bootstrap2-modal.js"></script>
<script src="./static/js/bootstrap/bootstrap2-tooltip.js"></script>
<script src="./static/js/bootstrap/bootstrap2-popover.js"></script>
<script src="./static/js/bootstrap/bootstrap2-collapse.js"></script>

<script src="./static/js/core/bootbox.js"></script>


<script src="./static/js/valid.js"></script>
<script src="./static/js/jquery.ui.totop.js"></script>

<script src="./static/js/jquery.idletimer.js"></script>

<script src="./static/js/d3.js" type="text/javascript"></script>
<script src="./static/js/d3.geom.js" type="text/javascript"></script>
<script src="./static/js/d3.layout.js" type="text/javascript"></script>

<script src="./static/js/visualizer.js" type="text/javascript"></script>

<script src="./static/js/core/utils.js"></script>
<script src="./static/js/core/pwdremind.js"></script>
<script src="./static/js/core/pwdremind.bigint.js"></script>
<script src="./static/js/core/pwdremind.crypto.js"></script>
<script src="./static/js/core/pwdremind.crypto.sha1.js"></script>
<script src="./static/js/core/pwdremind.crypto.srp.js"></script>
<script src="./static/js/core/pwdremind.session.js"></script>
<script src="./static/js/core/pwdremind.app.js"></script>


<script src="./static/js/core/view.visualizer.js"></script>
<script src="./static/js/core/view.pwdlist.js"></script>
<script src="./static/js/core/controller.js"></script>

<script src="./static/js/core/addmodal.js"></script>



<script src="./static/js/pwdremindui.js"></script>

<script src="./static/js/jquery.zclip.js"></script>
<script src="./static/js/passwordstrength.js"></script>
<script src="./static/js/pwdgen.js"></script>

<script>

$(document).ready(function() {

    // HACK zclip
    $('body').append('<a href="" id="hackzclip">hack</a>')
    $('#hackzclip').zclip({
        path: './static/media/ZeroClipboard.swf',
        copy: 'toto',
    }).hide();
    // END HACK

    var pwdremind = new Pwdremind.App();
    document.pwdremind = pwdremind;

    Controller.init(pwdremind, 'pwdlist');

    $("#login-modal").loginModal(pwdremind);

    $(".navbar a[href='#logout']").click(function (event) {
        event.preventDefault();
        pwdremind.logout();
    });

    // ADD modal
    $('#add-modal').addEditModal({'pwdremind':pwdremind});

    $(".navbar a[href='#add']").click(function (e) {
        e.preventDefault();
        $('#add-modal').addEditModal('show');
    });

    $(document).bind('pwdremind/logout', function(e){$('#add-modal').addEditModal('hide',false)});


    // Show/Hide password
    $("input#pwd + span>i").live("click", function() {
        var input = $('input#pwd').clone();

        if (input.attr('type') == 'password'){
            input.attr('type', 'text');
            $(this).removeClass('icon-eye-open').addClass('icon-eye-close');
        }else{
            input.attr('type', 'password');
            $(this).addClass('icon-eye-open').removeClass('icon-eye-close');
        }
        $("input#pwd").replaceWith(input);
    });

    // Pwdgen
    $("form#addentry i.icon-random").live("click", function() {
        $("input#pwd").val(PasswordGenerator());
    });

    // Pwdgen with options
    $("form#addentry i.icon-random").popover({
            live: true,
            html: true,
            delay: {show: 400, hide: 500},
            placement: 'left',
            offset: 0,
            title: "G&eacute;n&eacute;rateur de mots de passe",
            content: '\
            <form id="addentry-pwdgen"> \
            <fieldset>\
                <div class="control-group"> \
                    <label class="control-label">Options</label> \
                    <div class="controls"> \
                        <label class="radio"> \
                            <input type="radio" checked="" value="all" name="pwdgen-option"/> \
                            Tous caract&egrave;res imprimables \
                        </label> \
                        <label class="radio"> \
                            <input type="radio" value="alphanumeric" name="pwdgen-option"/> \
                            Uniquement des caract&egrave;res alphanum&eacute;riques \
                        </label> \
                        <label class="radio"> \
                            <input type="radio" value="alpha" name="pwdgen-option"/> \
                            Uniquement des lettres \
                        </label> \
                        <label class="radio"> \
                            <input type="radio" value="numeric" name="pwdgen-option"/> \
                            Uniquement des chiffres \
                        </label> \
                    </div> \
                </div> \
            </fieldset> \
                <div class="form-actions"> \
                    <button class="btn btn-primary" type="submit">G&eacute;n&eacute;rer</button> \
                </div> \
            </form> \
            '
    });

    $("form#addentry-pwdgen button").live("click", function() {
        var options = {}
        var choose = $('form#addentry-pwdgen input[name=pwdgen-option]:checked').val();

        switch (choose){
            case 'alphanumeric':
            options.special = false;
            break;

            case 'alpha':
            options.special = false;
            options.number = false;
            break;

            case 'numeric':
            options.special = false;
            options.letter = false;
            break;
        }
        console.log(options);
        $("input#pwd").val(PasswordGenerator(options));
        return false;
    });


    // END add modal

    $().UItoTop();

    pwdremind.init();
});
    </script>
    <!-- Topbar
    ================================================== -->
    <div class="navbar navbar-fixed-top" data-scrollspy="scrollspy" >
        <div class="navbar-inner">
            <div class="container">

                <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </a>

                <a class="brand" href="#">Password remind</a>
                <div class="nav-collapse">
                    <ul class="nav" id="controller">
                        <li><a href="#add">Ajouter</a></li>
                    </ul>
                    <ul class="nav pull-right">
                        <li><a href="#logout">Se d&eacute;connecter</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div id="login-modal" class="modal hide fade">

        <div class="modal-header">
            <h3>Connexion</h3>
        </div>

        <form id="login-form" action="" class="form-horizontal">
            <fieldset>
                <div class="modal-body">

                    <div class="control-group">
                        <label class="control-label" for="username">Identifiant</label>
                        <div class="controls">
                            <input type="text" class="input-xlarge" id="username" name="username" validation="required" />
                        </div>
                    </div>

                    <div class="control-group">
                        <label class="control-label" for="password">Mot de passe</label>
                        <div class="controls">
                            <input type="password" class="input-xlarge" id="password" name="password" validation="required" />
                        </div>
                    </div>

                    <div class="alert alert-error">
                        <p><strong>Erreur:</strong> Mauvais identifiant ou mot de passe.</p>
                    </div>
                </div>

                <div class="modal-footer">
                    <input type="submit" class="btn btn-primary" value="connexion" />
                </div>
            </fieldset>
        </form>

    </div>

    <div id="add-modal" class="modal hide fade">
        <div class="modal-header">
            <a class="close">&times;</a>
            <h3>Ajouter</h3>
        </div>
        <div class="modal-body">
            <div class="row">
            <div class="span5">
                <form id="addentry" action="" class="form-horizontal">
                    <fieldset>
                        <div class="control-group">
                            <label class="control-label" for="site">Site web</label>
                            <div class="controls">
                                <input type="text" class="" id="site" name="site" validation="required url" />
                            </div>
                        </div>
                        <div class="control-group">
                            <label class="control-label" for="login">Identifiant</label>
                            <div class="controls">
                                <input type="text" class="" id="login" name="login" validation="required" />
                            </div>
                        </div>
                        <div class="control-group">
                            <label class="control-label" for="login">Mot de passe</label>
                            <div class="controls">
                                <div class="input-prepend input-append">
                                    <span class="add-on"><i class="icon-random"></i></span><input type="password" class="" id="pwd" name="pwd" validation="required" autocomplete="off" /><span class="add-on"><i class="icon-eye-open"></i></span>
                                </div>
                            </div>
                        </div>
                    </fieldset>
                </form>
            </div>
            <div class="span4">
                <form id="addentryNote" action="">
                <fieldset>
                    <div class="control-group">
                        <div class="controls">
                            <textarea id="notes" rows="6" placeholder="Notes..."></textarea>
                        </div>
                    </div>
                </fieldset>
                </form>
            </div>


                </div>
        </div>

        <div class="modal-footer">
            <button type="cancel" class="btn">Annuler</button>
            <button type="submit" class="btn btn-primary">Sauvegarder</button>
        </div>
    </div>


    <div id="confirm-modal" class="modal hide fade">
        <div class="modal-header">
            <h3>Confirmer</h3>
        </div>

        <form id="confirm" action="">
            <fieldset>

                <div class="modal-body">
                    <p>Confirmez-vous la suppression?</p>
                </div>

                <div class="modal-footer">
                    <input type="submit" class="btn btn-primary" value="Confirmer">&nbsp;
                    <button id="cancelDelete" class="btn">Annuler</button>
                </div>

            </fieldset>
        </form>

    </div>

    <div class="container">

        <section id="pwdlist">

            <form id="search" class="well form-search">
                <input id="search" type="text" class="input-xlarge search-query" placeholder="Rechercher">
            </form>

            <table class="table table-striped" id="pwdlist-sites">
                <thead>
                    <tr>
                        <th class="blue sortable">Site</th>
                        <th class="green sortable">Identifiant</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </section>

        <section id="visualizer">
            <div class="page-header">
                <h1>Password Visualizer</h1>
            </div>

            <div id="chart">
            </div>
        </section>
    </div>

</body>
</html>
